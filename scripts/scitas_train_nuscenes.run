#!/bin/bash
#SBATCH --chdir /scratch/izar/USERNAME
#SBATCH --nodes 1
#SBATCH --ntasks 1
#SBATCH --cpus-per-task 20
#SBATCH --mem 180G
#SBATCH --partition gpu
#SBATCH --gres gpu:1
#SBATCH --time 5-12
#SBATCH --qos dlav
#SBATCH --account civil-459-2023

module load gcc/8.4.0-cuda python/3.7.7 cuda/11.1.1

CUDA_VISIBLE_DEVICES=0 \
/home/USERNAME/DLAV/venv/panoptic_bev/bin/python -m torch.distributed.launch --nproc_per_node=1 --master_addr=$(hostname -I | cut -d ' ' -f 1) --master_port=$(python /home/USERNAME/DLAV/PanopticBEV/scripts/get_port.py) /home/USERNAME/DLAV/PanopticBEV/scripts/train_panoptic_bev.py \
                                    --run_name=run12 \
                                    --project_root_dir=/home/USERNAME/DLAV/PanopticBEV \
                                    --seam_root_dir=/home/USERNAME/DLAV/nuscenes/nuScenes_panopticbev \
                                    --dataset_root_dir=/work/scitas-share/datasets/Vita/civil-459/NuScenes_full/US \
                                    --mode=train \
                                    --train_dataset=nuScenes \
                                    --val_dataset=nuScenes \
                                    --config=nuscenes.ini